<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>

  <title>Cửa hàng Bongstudio</title>
  <meta name="description" content="Cửa hàng Bongstudio – kho sản phẩm chọn lọc cho cộng đồng Bongstudio, mỗi món đều có link mua rõ ràng, ưu tiên dễ dùng, giá hợp lý.">
  <link rel="canonical" href="https://bongstudio68.github.io/store.html"/>
  <meta name="robots" content="index,follow"/>

  <!-- OPEN GRAPH -->
  <meta property="og:title" content="Cửa hàng Bongstudio"/>
  <meta property="og:description" content="Kho sản phẩm chọn lọc, link affiliate minh bạch, giúp Bongstudio có thêm thu nhập để duy trì nội dung."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://bongstudio68.github.io/store.html"/>

  <style>
    :root{
      --bg:#020617;
      --bg-soft:#020617;
      --bg-card:#020617;
      --fg:#e5e7eb;
      --fg-soft:#9ca3af;
      --accent:#ec4899;
      --accent-soft:#f9a8d4;
      --border:#1f2933;
      --chip:#0b1120;
      --danger:#ef4444;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    html,body{height:100%;}
    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#111827 0,#020617 55%,#000 100%);
      color:var(--fg);
      -webkit-font-smoothing:antialiased;
    }
    a{text-decoration:none;color:inherit;}

    .page{
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }
    .shell{
      width:100%;
      max-width:1200px;
      margin:0 auto;
      padding:16px 16px 40px;
    }

    /* HEADER SITE */
    .site-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:8px 16px;
      margin-bottom:8px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:700;
    }
    .brand-main{
      font-size:20px;
      color:#f9a8d4;
    }
    .brand-sub{
      font-size:11px;
      color:var(--fg-soft);
    }
    .nav-links{
      display:flex;
      gap:12px;
      font-size:14px;
    }
    .nav-links a{
      padding:6px 12px;
      border-radius:999px;
      background:#020617;
      border:1px solid #111827;
      color:var(--fg-soft);
    }
    .nav-links a.active{
      background:var(--accent);
      border-color:var(--accent);
      color:#fff;
    }

    /* PAGE HEADER */
    .page-header{
      padding:8px 16px 12px;
    }
    .page-title{
      font-size:22px;
      font-weight:700;
      margin-bottom:4px;
    }
    .page-desc{
      font-size:14px;
      color:var(--fg-soft);
      max-width:640px;
    }

    /* FILTER BAR */
    .filter-bar-wrap{
      padding:8px 16px 0;
    }
    .filter-bar{
      border-radius:999px;
      border:1px solid var(--border);
      background:#020617;
      padding:10px 14px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .filter-group{
      display:flex;
      align-items:center;
      gap:6px;
      font-size:14px;
      color:var(--fg-soft);
    }
    .filter-label{
      white-space:nowrap;
    }
    .filter-select{
      min-width:160px;
      padding:6px 28px 6px 10px;
      border-radius:999px;
      border:1px solid #111827;
      background:#020617;
      color:var(--fg);
      font-size:14px;
      appearance:none;
      position:relative;
    }
    .filter-select:focus{
      outline:1px solid var(--accent-soft);
      outline-offset:1px;
    }
    .filter-select-wrap{
      position:relative;
    }
    .filter-select-wrap::after{
      content:"▾";
      position:absolute;
      right:10px;
      top:50%;
      transform:translateY(-50%);
      font-size:11px;
      color:var(--fg-soft);
      pointer-events:none;
    }

    /* META ABOVE GRID */
    .section-head{
      padding:18px 16px 8px;
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:flex-end;
    }
    .section-title{
      font-size:16px;
      font-weight:600;
    }
    .section-meta{
      font-size:12px;
      color:var(--fg-soft);
      text-align:right;
    }
    .section-meta strong{color:var(--accent-soft);}

    /* GRID */
    .product-grid{
      padding:8px 12px 32px;
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(190px,1fr));
      gap:14px;
    }

    .product-card{
      background:linear-gradient(145deg,#020617,#020617 60%,#020617);
      border-radius:18px;
      border:1px solid #111827;
      padding:10px 10px 12px;
      display:flex;
      flex-direction:column;
      gap:8px;
      box-shadow:0 0 0 1px rgba(15,23,42,0.7);
    }
    .product-card:hover{
      border-color:var(--accent-soft);
      box-shadow:0 0 0 1px rgba(236,72,153,0.4);
      transform:translateY(-1px);
      transition:all .16s ease-out;
    }

    .product-thumb{
      width:100%;
      border-radius:14px;
      overflow:hidden;
      background:#020617;
      border:1px solid #111827;
      aspect-ratio:4/5;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .product-thumb img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .product-body{
      display:flex;
      flex-direction:column;
      gap:4px;
      font-size:13px;
    }
    .product-name{
      font-size:13px;
      font-weight:600;
      line-height:1.3;
    }
    .product-merchant{
      font-size:12px;
      color:var(--fg-soft);
    }

    .product-footer{
      margin-top:4px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .price-wrap{
      display:flex;
      flex-direction:column;
      gap:2px;
      font-size:12px;
    }
    .price-main{
      font-weight:700;
      color:var(--accent-soft);
    }
    .price-old{
      text-decoration:line-through;
      color:var(--fg-soft);
      font-size:11px;
    }

    .btn-buy{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:6px 10px; /* nhỏ hơn bản cũ */
      border-radius:999px;
      border:none;
      background:var(--accent);
      color:white;
      font-size:11.5px;
      font-weight:600;
      white-space:nowrap;
      cursor:pointer;
      flex-shrink:0;
    }
    .btn-buy:hover{
      filter:brightness(1.08);
    }

    /* EMPTY STATE */
    .empty{
      padding:24px 16px;
      font-size:13px;
      color:var(--fg-soft);
    }

    /* RESPONSIVE */
    @media (max-width:768px){
      .site-header{padding-inline:8px;}
      .shell{padding-inline:10px;}
      .filter-bar{
        border-radius:16px;
        align-items:flex-start;
      }
      .filter-select{min-width:140px;}
      .section-head{
        flex-direction:column;
        align-items:flex-start;
      }
      .section-meta{text-align:left;}
    }
  </style>
</head>
<body>
<div class="page">
  <header class="site-header">
    <div class="brand">
      <div>
        <div class="brand-main">Bongstudio</div>
        <div class="brand-sub">Cửa hàng affiliate đa sàn</div>
      </div>
    </div>
    <nav class="nav-links">
      <a href="/" data-nav="home">Trang chủ</a>
      <a href="/store.html" data-nav="store" class="active">Cửa hàng</a>
    </nav>
  </header>

  <main class="shell">
    <section class="page-header">
      <h1 class="page-title">Cửa hàng Bongstudio</h1>
      <p class="page-desc">
        Đây là kho sản phẩm chọn lọc cho cộng đồng Bongstudio – mỗi món đều có link mua rõ ràng,
        ưu tiên dễ dùng, giá hợp lý. Toàn bộ link là link affiliate: giá bạn không đổi, Bongstudio được thêm chút
        hoa hồng để duy trì nội dung.
      </p>
    </section>

    <!-- FILTER BAR -->
    <section class="filter-bar-wrap">
      <div class="filter-bar">
        <div class="filter-group">
          <span class="filter-label">Danh mục:</span>
          <div class="filter-select-wrap">
            <select id="filter-category" class="filter-select">
              <option value="all">Tất cả danh mục</option>
              <!-- Các option còn lại sẽ được JS tự thêm dựa vào data -->
            </select>
          </div>
        </div>

        <div class="filter-group">
          <span class="filter-label">Sàn:</span>
          <div class="filter-select-wrap">
            <select id="filter-merchant" class="filter-select">
              <option value="all">Tất cả</option>
              <option value="shopee">Shopee</option>
              <option value="lazada">Lazada</option>
              <option value="tiktok">TikTok</option>
              <option value="tiki">Tiki</option>
            </select>
          </div>
        </div>
      </div>
    </section>

    <!-- META + GRID -->
    <section aria-label="Danh sách sản phẩm">
      <div class="section-head" id="product-list-anchor">
        <div class="section-title" id="section-title">
          Tất cả sản phẩm
        </div>
        <div class="section-meta">
          <div>Đang hiển thị <strong id="product-count">0</strong> sản phẩm.</div>
          <div>Dữ liệu lấy từ <code>/assets/data/affiliates.json</code></div>
        </div>
      </div>

      <div id="product-grid" class="product-grid">
        <!-- JS render -->
      </div>

      <div id="empty-state" class="empty" style="display:none;">
        Hiện tại chưa tìm thấy sản phẩm nào khớp với bộ lọc. Thử đổi lại danh mục hoặc sàn hiển thị nhé.
      </div>
    </section>
  </main>
</div>

<script>
(function(){
  const CATEGORY_LABELS = {
    "gia-dung":"Gia dụng, decor nhà cửa",
    "thoi-trang-nu":"Thời trang nữ",
    "thoi-trang-nam":"Thời trang nam",
    "quan-ao-em-be":"Quần áo em bé",
    "suc-khoe-tpcn":"Sức khỏe & TPCN",
    "sach":"Sách",
    "do-an-do-uong":"Đồ ăn & đồ uống",
    // fallback cũ:
    "thoi-trang":"Thời trang",
    "my-pham":"Mỹ phẩm",
    "trang-suc":"Trang sức"
  };

  const MERCHANT_LABELS = {
    shopee:"Shopee",
    lazada:"Lazada",
    tiktok:"TikTok",
    tiki:"Tiki"
  };

  const catSelect = document.getElementById("filter-category");
  const merchantSelect = document.getElementById("filter-merchant");
  const gridEl = document.getElementById("product-grid");
  const countEl = document.getElementById("product-count");
  const emptyEl = document.getElementById("empty-state");
  const sectionTitleEl = document.getElementById("section-title");

  let ALL_PRODUCTS = [];

  function formatVnd(value){
    if(value == null || isNaN(value)) return "";
    try{
      return value.toLocaleString("vi-VN")+"đ";
    }catch(e){
      return value + "đ";
    }
  }

  function buildCategoryOptions(products){
    const set = new Set();
    products.forEach(p=>{
      if(p.category){
        set.add(p.category);
      }
    });

    // Xoá hết option != all
    Array.from(catSelect.options).forEach(opt=>{
      if(opt.value !== "all"){
        catSelect.removeChild(opt);
      }
    });

    Array.from(set).sort().forEach(slug=>{
      const opt = document.createElement("option");
      opt.value = slug;
      opt.textContent = CATEGORY_LABELS[slug] || slug.replace(/-/g," ");
      catSelect.appendChild(opt);
    });
  }

  function applyInitialFiltersFromURL(){
    const params = new URLSearchParams(window.location.search);
    const catParam = params.get("cat") || params.get("category");
    const merchantParam = params.get("merchant");

    if(catParam && catSelect.querySelector('option[value="'+catParam+'"]')){
      catSelect.value = catParam;
      // scroll nhẹ xuống phần sản phẩm cho cảm giác "click danh mục" mượt hơn
      setTimeout(function(){
        const anchor = document.getElementById("product-list-anchor");
        if(anchor){
          anchor.scrollIntoView({behavior:"smooth",block:"start"});
        }
      },300);
    }

    if(merchantParam && merchantSelect.querySelector('option[value="'+merchantParam+'"]')){
      merchantSelect.value = merchantParam;
    }
  }

  function renderProducts(){
    const selectedCat = catSelect.value || "all";
    const selectedMerchant = merchantSelect.value || "all";

    let filtered = ALL_PRODUCTS.slice();

    filtered = filtered.filter(p=>{
      const catOk = (selectedCat==="all") || (p.category === selectedCat);
      const mOk = (selectedMerchant==="all") || (p.merchant === selectedMerchant);
      return catOk && mOk;
    });

    gridEl.innerHTML = "";

    if(!filtered.length){
      emptyEl.style.display = "block";
      countEl.textContent = "0";
    }else{
      emptyEl.style.display = "none";
      const frag = document.createDocumentFragment();

      filtered.forEach(p=>{
        const link = p.deeplink || p.origin_url || "#";
        const merchantLabel = MERCHANT_LABELS[p.merchant] || p.merchant || "Sàn khác";

        const card = document.createElement("article");
        card.className = "product-card";

        const thumb = document.createElement("div");
        thumb.className = "product-thumb";
        const img = document.createElement("img");
        img.loading = "lazy";
        img.alt = p.name || "";
        img.src = p.image || "/assets/img/placeholder-product.webp";
        thumb.appendChild(img);

        const body = document.createElement("div");
        body.className = "product-body";

        const nameEl = document.createElement("div");
        nameEl.className = "product-name";
        nameEl.textContent = p.name || "Sản phẩm chưa đặt tên";

        const merchantEl = document.createElement("div");
        merchantEl.className = "product-merchant";
        merchantEl.textContent = "Nguồn: " + merchantLabel;

        body.appendChild(nameEl);
        body.appendChild(merchantEl);

        const footer = document.createElement("div");
        footer.className = "product-footer";

        const priceWrap = document.createElement("div");
        priceWrap.className = "price-wrap";

        if(p.price_vnd){
          const priceMain = document.createElement("div");
          priceMain.className = "price-main";
          priceMain.textContent = formatVnd(p.price_vnd);
          priceWrap.appendChild(priceMain);
        }

        if(p.price_old){
          const priceOld = document.createElement("div");
          priceOld.className = "price-old";
          priceOld.textContent = formatVnd(p.price_old);
          priceWrap.appendChild(priceOld);
        }

        const buyBtn = document.createElement("a");
        buyBtn.className = "btn-buy";
        buyBtn.href = link;
        buyBtn.target = "_blank";
        buyBtn.rel = "nofollow noopener";
        // để người dùng có thể chuột phải -> Copy link địa chỉ
        buyBtn.textContent = "Mua ngay trên " + merchantLabel;

        footer.appendChild(priceWrap);
        footer.appendChild(buyBtn);

        card.appendChild(thumb);
        card.appendChild(body);
        card.appendChild(footer);

        frag.appendChild(card);
      });

      gridEl.appendChild(frag);
      countEl.textContent = String(filtered.length);
    }

    // Cập nhật tiêu đề section
    let title = "Tất cả sản phẩm";
    const cat = catSelect.value;
    if(cat && cat !== "all"){
      title = CATEGORY_LABELS[cat] || "Danh mục";
    }
    sectionTitleEl.textContent = title;
  }

  function initEvents(){
    catSelect.addEventListener("change",renderProducts);
    merchantSelect.addEventListener("change",renderProducts);
  }

  function fetchData(){
    fetch("/assets/data/affiliates.json",{cache:"no-store"})
      .then(function(res){return res.json();})
      .then(function(data){
        if(!Array.isArray(data)) data = [];
        // loại các sản phẩm bị ẩn nếu có
        ALL_PRODUCTS = data.filter(function(p){
          return !p.status || p.status === "active" || p.status === "ok";
        });

        buildCategoryOptions(ALL_PRODUCTS);
        applyInitialFiltersFromURL();
        renderProducts();
      })
      .catch(function(err){
        console.error("Lỗi tải affiliates.json",err);
        ALL_PRODUCTS = [];
        renderProducts();
      });
  }

  // init
  initEvents();
  fetchData();
})();
</script>
</body>
</html>
